# Add multimedia codecs
echo "${green}${bold}ADDING MULTIMEDIA CODECS${reset}"
sudo dnf groupupdate -y multimedia --setop="install_weak_deps=False" --exclude=PackageKit-gstreamer-plugin 
sudo dnf groupupdate -y  sound-and-video 

# Audio and Video plugins
echo "${green}${bold}ADDING AUDIO AND VIDEO PLUGINS${reset}"
sudo dnf install -y gstreamer1-plugins-{bad-\*,good-\*,base} gstreamer1-plugin-openh264 gstreamer1-libav --exclude=gstreamer1-plugins-bad-free-devel 
sudo dnf install -y lame\* --exclude=lame-devel 
sudo dnf group upgrade -y --with-optional Multimedia 

# DVD codecs
echo "${green}${bold}ADDING DVD CODECS${reset}"
sudo dnf install -y rpmfusion-free-release-tainted 
sudo dnf install -y libdvdcss 

# Nonfree firmawre 
echo "${green}${bold}ADDING NONFREE FIRMWARE${reset}"
sudo dnf install -y rpmfusion-nonfree-release-tainted 
sudo dnf install -y \*-firmware 

# Intel multimedia codecs
echo "${green}${bold}ADDING INTEL VIDEO ACCELERATION API${reset}"
sudo dnf install -y intel-media-driver 
sudo dnf install -y libva-intel-driver 

# Codecs 
echo "${green}${bold}ADDING FFMPEG CODECS${reset}"
sudo dnf install -y ffmpeg 

sudo dnf install -y neovim python3-neovim 


# Nodejs for neovim plugins
echo "${green}${bold}INSTALLING NODEJS FOR VIM PLUGINS${reset}"
sudo dnf install -y nodejs 


# Nnn
echo "${green}${bold}INSTALLING NNN. FILE MANAGER IN TERMINAL${reset}"
sudo dnf install -y nnn 

# ClamAV
echo "${green}${bold}INSTALLING CLAMAV. BEST LINUX ANTIVIRUS${reset}"
sudo dnf install -y clamav clamd clamav-update clamtk 
sudo setsebool -P antivirus_can_scan_system 1
sudo systemctl stop clamav-freshclam
sudo freshclam 
sudo freshclam 
sudo systemctl start clamav-freshclam 
sudo systemctl enable clamav-freshclam 

# Firewalld GUI
echo "${green}${bold}INSTALLING FIREWALL GUI${reset}"
sudo dnf install -y firewall-config 
 

# Kernel headers
echo "${green}${bold}INSTALLING KERNEL HEADERS. IT'S TAKE A TIME. PLEASE WAIT!${reset}"
sudo dnf install -y "kernel-devel-$(uname -r)" 
sudo dnf install -y dkms 

# Virtualbox
echo "${green}${bold}INSTALLING VIRTUALBOX${reset}"
sudo dnf install -y VirtualBox akmod-VirtualBox 
sudo akmods 
sudo systemctl restart vboxdrv  
lsmod  | grep -i vbox 
sudo usermod -a -G vboxusers $USER   
sudo modprobe vboxdrv

# Virtualbox extensions pack
echo "${green}${bold}INSTALLING VIRTUALBOX EXTENSION PACK${reset}"
cd ~/.gc
mkdir -p VirtualBox
cd VirtualBox
LatestVirtualBoxVersion=$(wget -qO - https://download.virtualbox.org/virtualbox/LATEST-STABLE.TXT) && wget "https://download.virtualbox.org/virtualbox/${LatestVirtualBoxVersion}/Oracle_VM_VirtualBox_Extension_Pack-${LatestVirtualBoxVersion}.vbox-extpack" &&
yes | sudo VBoxManage extpack install --replace Oracle_VM_VirtualBox_Extension_Pack-${LatestVirtualBoxVersion}.vbox-extpack &&
cd

# Virtualbox NAT Network nad Host-only Network
echo "${green}${bold}ADDING VIRTUALBOX NAT AND HOST-ONLY NETWORKS${reset}"
VBoxManage natnetwork add --netname NatNetwork --network "10.0.2.0/24" --enable 
VBoxManage hostonlyif create 

# Open-vm-tools for cooperate with vm
sudo dnf install -y open-vm-tools

# Vmware Workstation
echo "${green}${bold}INSTALLING VMWARE WORKSTATION. IT'S TAKE A TIME. PLEASE WAIT!${reset}"
cd ~/.gc
wget -q --user-agent="Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:94.0) Gecko/20100101 Firefox/94.0" https://www.vmware.com/go/getworkstation-linux 
chmod a+x getworkstation-linux
sudo ./getworkstation-linux  --console --required --eulas-agreed
rm getworkstation-linux

# Virt-manager for KVM
echo "${green}${bold}INSTALLING VIRT MANAGER FOR KVM${reset}"
sudo dnf group install -y --with-optional virtualization 
sudo systemctl start libvirtd
sudo systemctl enable libvirtd 
sudo usermod -a -G libvirt $USER 


# Perl for fzf, Rust, Python pip
echo "${green}${bold}INSTALLING PERL, RUST. POPULAR PROGRAMMING LANGUAGES IN LINUX. FOR APPS USED IN SYSTEM${reset}"
sudo dnf install -y perl 
sudo dnf install -y rust cargo 

# Python pip, meson
echo "${green}${bold}INSTALLING PHP PIP, MESON, CMAKE, JQ. BUILD SYSTEM FOR APPS${reset}"
sudo dnf install -y python3-pip 
sudo dnf install -y meson 
sudo dnf install -y cmake 
sudo dnf install -y jq 

# Xfce polkit for password popups
sudo dnf install -y xfce-polkit

# Bluez for bluetooth 
echo "${green}${bold}INSTALLING BLUEZ. BLUETOOTH PROTOCOL STACK FOR LINUX${reset}"
sudo dnf -y install bluez bluez-tools 
# bluetoothctl discoverable on 

# Blueman for bluetooth applet
echo "${green}${bold}INSTALLING BLUEMAN. BLUETOOTH APPLET${reset}"
sudo dnf install -y blueman 

# KDE connect for bluetooth connection with android phone
sudo dnf install -y sudo dnf install kde-connect

# Firewall rule for kde-connect
sudo firewall-cmd --permanent --zone=public --add-service=kdeconnect
sudo firewall-cmd --reload

# Scrcpy for android phone screen sharing when connected by usb and usb-debbuging is enabled
sudo dnf copr enable -y zeno/scrcpy
sudo dnf install -y scrcpy

# Playerctl for control media with keyboard
sudo dnf install -y playerctl

# Bash aliases for user
echo "${green}${bold}ADING BASH ALIASES FOR USER${reset}"
bash -c 'echo "
if [ -f ~/.bash_aliases ]; then
. ~/.bash_aliases
fi">> ~/.bashrc'

# Bash aliases for sudo/root
echo "${green}${bold}ADDING BASH ALIASES TO ROOT USER${reset}"
sudo bash -c 'echo "
if [ -f ~/.bash_aliases ]; then
. ~/.bash_aliases
fi">> ~/.bashrc'

# ZSH 
echo "${green}${bold}INSTALLING ZSH. UNIX SHELL WITH NEW FUTURES${reset}"
sudo dnf install -y util-linux-user 
sudo dnf install -y sqlite zsh 
sudo chsh -s $(which zsh) $USER 

# FZF
echo "${green}${bold}INSTALLING FZF. COMMAND LINE FUZY FINDER ${reset}"
cd .gc
git clone --quiet --depth 1 https://github.com/junegunn/fzf.git ~/.fzf 
yes | ~/.fzf/install 
cd

# Oh-my-zsh
echo "${green}${bold}INSTALLING OH MY ZSH. FRAMEWORK FOR ZSH${reset}"
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended 

# Oh-my-zsh plugins
echo "${green}${bold}ADDING ZSH PLUGINS${reset}"
git clone --quiet https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting 
git clone --quiet https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions 

# Powerlevel10k zsh
echo "${green}${bold}INSTALLING POWERLEVEL10K. ZSH THEME${reset}"
cd ~/.gc
git clone --quiet --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k 

# Fonts 
echo "${green}${bold}ADDING FONTS TO SYSTEM ${reset}"
sudo dnf install -y powerline-fonts 
sudo dnf install -y cabextract xorg-x11-font-utils 
cd ~/.gc
git clone --quiet https://github.com/pietryszak/fonts.git 
cd fonts
sudo dnf install -y msttcore-fonts-installer-2.6-1.noarch.rpm 
mkdir -p ~/.local/share/fonts
cp feather.ttf ~/.local/share/fonts
cp iosevka_nerd_font.ttf ~/.local/share/fonts
cp MesloLGS* ~/.local/share/fonts/
cp weathericons-regular-webfont.ttf ~/.local/share/fonts
fc-cache -fv >> ~/.gc/fedora-installer/install-log
cd

# i3-wifi applet
echo "${green}${bold}INSTALLING I3 WIFI APPLET${reset}"
sudo dnf install -y network-manager-applet 

# Polybar Spotify 
echo "${green}${bold}INSTALLING POLYBAR SPOTIFY APPLET${reset}"
cd ~/.gc
git clone --quiet https://github.com/Jvanrhijn/polybar-spotify.git 
cd

# Gnome-polkit - dispaly popup fot password for sudo 
echo "${green}${bold}INSTALLING GNOME POLKIT. POPUP WITH PASSWORD OF SUDO${reset}"
sudo dnf install -y polkit-gnome 


# Solaar logitch devices control app
sudo dnf install -y solaar
 

# GTK Gruvbox theme
echo "${green}${bold}INSTALLING GRUVBOX THEME${reset}"
cd ~/.gc
git clone --quiet https://github.com/pietryszak/gruvbox-material-gtk.git 
cd gruvbox-material-gtk
mkdir -p ~/.local/share/themes/
cp -r themes/* ~/.local/share/themes/
mkdir -p ~/.themes
cp -r themes/* ~/.themes
sudo cp -r themes/* /usr/share/themes/
cd
sudo flatpak override --filesystem=$HOME/.themes
sudo flatpak override --env=GTK_THEME=Gruvbox-Material-Dark
sudo bash -c 'echo "GTK_THEME=Gruvbox-Material-Dark" >> /etc/environment'

# QT5 apps theme
echo "${green}${bold}SET QT5 APPS THEME${reset}"
sudo dnf install -y qt5ct 
sudo bash -c 'echo "QT_QPA_PLATFORMTHEME=qt5ct" >> /etc/environment'
sudo dnf install -y qt5-qtstyleplugins 

# Papirus gtk icons for gruvbox 
echo "${green}${bold}SET GTK ICONS${reset}"
cd ~/.gc
sudo wget -qO- https://git.io/papirus-icon-theme-install | sh 

# Papirus hardcoded icons
sudo dnf config-manager --add-repo https://download.opensuse.org/repositories/home:SmartFinn:hardcode-tray/Fedora_35/home:SmartFinn:hardcode-tray.repo -y
sudo dnf install -y hardcode-tray
sudo -E hardcode-tray --apply --conversion-tool RSVGConvert --size 22 --theme Papirus

# Papirus folders
echo "${green}${bold}SET FOLDERS COLORS${reset}"
wget -qO- https://git.io/papirus-folders-install | sh 
papirus-folders -C brown --theme Papirus-Dark 
cd

# GTK theme
echo "${green}${bold}SETTING DARK GTK THEME${reset}"
gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
gsettings set org.gnome.desktop.interface gtk-theme "Gruvbox-Material-Dark"

# Sensors
echo "${green}${bold}INSTALLING SENSORS APP AND FINDING ALL SENSORS IN SYSEM. IT'S TAKE A TIME. PLEASE WAIT!${reset}"
sudo dnf install -y lm_sensors 
yes | sudo sensors-detect 

# My dotfiles
echo "${green}${bold}COPY ALL MY DOTFILES TO PROPER FOLDERS${reset}"
cd ~/.gc
git clone --quiet https://github.com/pietryszak/dotfiles.git 
cd

# Copy libreoffice config to to proper folde
mkdir -p ~/.config/libreoffice/4/user
cp -r ~/.gc/dotfiles/libreoffice/* ~/.config/libreoffice/4/user/

# Copy bat  config to proper folder
cp -r ~/.gc/dotfiles/bat ~/.config

# Copy Code config to proper folder
cp -r ~/.gc/dotfiles/Code/settings.json ~/.config/Code/User/

# Copy htop config to proper folder 
cp -r ~/.gc/dotfiles/htop ~/.config

# Copy neofetch config to proper folder
cp -r ~/.gc/dotfiles/neofetch ~/.config

# Copy nvim config to proper folder
cp -r ~/.gc/dotfiles/nvim ~/.config

# Copy VirtualBox config to proper folder 
cp -r ~/.gc/dotfiles/VirtualBox ~/.config
chmod +x ~/.config/VirtualBox/update.sh

# Copy VmWare config to proper folder
mkdir ~/.vmware
cp -r ~/.gc/dotfiles/vmware/preferences ~/.vmware

# Copy zsh sripts to proper folder
cp -r ~/.gc/dotfiles/zsh/scripts/* ~/.oh-my-zsh/custom

# Copy zshrc config to proper folder
cp -r ~/.gc/dotfiles/zsh/.zshrc ~/

# Copy powerlevel10k config to proper folder
cp -r ~/.gc/dotfiles/zsh/.p10k.zsh ~/

# Copy terminator config to proper folder
cp -r ~/.gc/dotfiles/terminator/ ~/.config

# Copy kitty config to proper folder
cp -r ~/.gc/dotfiles/kitty/ ~/.config

# Copy TeamViewer config to proper folder
cp -r ~/.gc/dotfiles/teamviewer/ ~/.config

# Copy Redshift config to proper folder
cp -r ~/.gc/dotfiles/redshift/ ~/.config

# Copy Redshift config to proper folder
cp -r ~/.gc/dotfiles/joplin/* ~/.config/joplin-desktop

# Copy bash_aliases to user folder
cp -r ~/.gc/dotfiles/bashrc/.bash_aliases ~/ 

# Copy bash_aliases to sudo/root folder
sudo cp -r ~/.gc/dotfiles/bashrc/.bash_aliases /root  

# Copy qt5ct config to to proper folder
cp -r ~/.gc/dotfiles/qt5ct ~/.config

# Copy gtk config to to proper folder
cp ~/.gc/dotfiles/gtk/.gtkrc-2.0 ~
mkdir ~/.config/gtk-3.0/
cp ~/.gc/dotfiles/gtk/settings.ini ~/.config/gtk-3.0/

# Copy arandr config to to proper folder
mkdir ~/.screenlayout
cp -r ~/.gc/dotfiles/screenlayout/pc/* ~/.screenlayout
chmod +x ~/.screenlayout/*

# Copy shortcuts list to proper folder
cp -r ~/.gc/dotfiles/shortcuts ~/.config

# Copy i3 config to to proper folder
cp -r ~/.gc/dotfiles/i3 ~/.config
rm ~/.config/i3/scripts/vmware-workspaces

# Copy polybar config to to proper folder
cp -r ~/.gc/dotfiles/polybar ~/.config
chmod +x ~/.config/polybar/cuts/scripts/launcher.sh
chmod +x ~/.config/polybar/cuts/scripts/powermenu.sh
chmod +x ~/.config/polybar/scripts/*
cp ~/.gc/polybar-spotify/spotify_status.py ~/.config/polybar/scripts/
sed -i -e '/play_pause/s/25B6/F909/' ~/.config/polybar/scripts/spotify_status.py 
sed -i -e '/play_pause/s/23F8/F8E3/' ~/.config/polybar/scripts/spotify_status.py 

# Copy volumeicon config to to proper folder
cp -r ~/.gc/dotfiles/volumeicon/* ~/.config/volumeicon

# Copy bpytop config to to proper folder
mkdir  ~/.config/bpytop/
cp -r ~/.gc/dotfiles/bpytop/* ~/.config/bpytop/

# Copy update script to to proper folder
mkdir ~/.scripts
cp -r ~/.gc/dotfiles/update/* ~/.scripts
chmod +x ~/.scripts/update.sh

# Copy lightdm script to to proper folder
sudo cp -r ~/.gc/dotfiles/lightdm/* /etc/lightdm/

# Add Wallpapers
cd ~/Pictures
git clone https://github.com/pietryszak/wallpapers
sudo cp ~/Pictures/wallpapers/caffe-gruvbox.png /usr/share/pixmaps/

# My Vivaldi browser profile public
echo "${green}${bold}COPY VIVALDI PROFILE WITH ADDONS AND THEME${reset}"
cd ~/.gc/dotfiles
mkdir vivaldi
cd vivaldi
wget -q https://sysoply.pl/download/public/vivaldi-profile-public.7z 
7z x vivaldi-profile-public.7z 
mkdir ~/.config/vivaldi/
cp -r ~/.gc/dotfiles/vivaldi/Default ~/.config/vivaldi/

# Copy vivaldi speeddial icons to to proper folder
cp -r ~/.gc/dotfiles/vivaldi-icons ~/Pictures

# My FF profile public
echo "${green}${bold}COPY FIREFOX PROFILE WITH ADDONS AN THEME${reset}"
cd ~/.gc/dotfiles
wget https://sysoply.pl/download/public/mozilla-profile-public.7z
7z x mozilla-profile-public.7z
cp -r .mozilla ~/

# My FF cache profile
cd ~/.gc/dotfiles
wget https://sysoply.pl/download/public/mozilla-cache-public.7z
7z x mozilla-cache-public.7z
cp -r mozilla ~/.cache

# My Thunderbird profile public
echo "${green}${bold}COPY THUNDERBIRD PROFILE WITH ADDONS AND THEME${reset}"
cd ~/.gc/dotfiles
wget -q https://sysoply.pl/download/public/thunderbird-profile-public.7z 
7z x thunderbird-profile-public.7z 
cp -r .thunderbird ~/

# My Thunderbird cache public
cd ~/.gc/dotfiles
wget -q https://sysoply.pl/download/public/thunderbird-cache-public.7z 
7z x thunderbird-cache-public.7z 
cp -r thunderbird ~/.cache
cd


# Last update
echo "${green}${bold}UPDATE SYSTEM BEFORE RESTART${reset}"
sudo dnf upgrade --refresh 
sudo dnf upgrade -y 
sudo dnf autoremove -y 


# Reboot
echo "${MAGENTA}${bold}INSTALLATION SUCCESFULL !! REBOOT SYSTEM${reset}"
sudo reboot
